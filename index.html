<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Phaser Pokelike</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
  body { margin:0; background:#000; overflow:hidden; }
  canvas { image-rendering: pixelated; }
</style>

<script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
</head>
<body>

<script>
const config = {
    type: Phaser.AUTO,
    width: 320,
    height: 240,
    zoom: 2,
    pixelArt: true,
    physics: {
        default: 'arcade',
        arcade: {
            debug: false   // ğŸ”¥ ã“ã‚ŒãŒé‡è¦ï¼
        }
    },
    scene: {
        preload,
        create,
        update
    }
};


let player;
let cursors;

new Phaser.Game(config);

function preload() {
    // ãƒãƒƒãƒ—ï¼ˆ1024x1024ï¼‰
    this.load.image("map", "assets/map.png");

    // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆ3ãƒ•ãƒ¬ãƒ¼ãƒ Ã—4æ–¹å‘ï¼‰
    this.load.spritesheet("player", "assets/player_fixed.png", {
        frameWidth: 32,
        frameHeight: 32
    });
}

function create() {
    // ãƒãƒƒãƒ—ã‚’ç”»é¢ã«ãƒ•ã‚£ãƒƒãƒˆã•ã›ã¦è¡¨ç¤ºï¼ˆå·¦ä¸ŠåŸºæº–ï¼‰
    const bg = this.add.image(0, 0, "map").setOrigin(0, 0);
    const scaleX = 320 / bg.width;
    const scaleY = 240 / bg.height;
    bg.setScale(scaleX, scaleY);

    // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä¸­å¤®ã«é…ç½®
    player = this.physics.add.sprite(160, 120, "player");

    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ3ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹æˆï¼‰
    this.anims.create({
        key:"down",
        frames: this.anims.generateFrameNumbers("player",{ start:0, end:2 }),
        frameRate: 8,
        repeat:-1
    });
    this.anims.create({
        key:"left",
        frames: this.anims.generateFrameNumbers("player",{ start:3, end:5 }),
        frameRate: 8,
        repeat:-1
    });
    this.anims.create({
        key:"right",
        frames: this.anims.generateFrameNumbers("player",{ start:6, end:8 }),
        frameRate: 8,
        repeat:-1
    });
    this.anims.create({
        key:"up",
        frames: this.anims.generateFrameNumbers("player",{ start:9, end:11 }),
        frameRate: 8,
        repeat:-1
    });

    cursors = this.input.keyboard.createCursorKeys();
}

function update() {
    const speed = 85;
    player.setVelocity(0);

    if (cursors.left.isDown) {
        player.setVelocityX(-speed);
        player.anims.play("left", true);
    } else if (cursors.right.isDown) {
        player.setVelocityX(speed);
        player.anims.play("right", true);
    } else if (cursors.up.isDown) {
        player.setVelocityY(-speed);
        player.anims.play("up", true);
    } else if (cursors.down.isDown) {
        player.setVelocityY(speed);
        player.anims.play("down", true);
    } else {
        player.anims.stop();
    }
}
</script>

</body>
</html>
